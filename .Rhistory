# import libraries
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# read the file using the absolute path of my file
# https://www.kaggle.com/datasets/kewagbln/absenteeism-at-work-uci-ml-repositiory
# https://archive.ics.uci.edu/ml/datasets/Absenteeism+at+work
absent <- read.csv(file = "/Users/yongyetan/Desktop/Area51/AbsenteeismAtWork/Absenteeism_at_work.csv", sep = ";")
absent
# data clean up to see if there is any NA's
summary(absent)
ggplot(date = absent) %>%
group_by(age)
ggplot(date = absent) %>%
group_by(age) %>%
summarise(average = mean(Work.load.Average.day))
absent %>%
group_by(age) %>%
summarise(average = mean(Work.load.Average.day))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point()
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(color = Age )
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth()
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green")
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green") +
scale_x_continuous(breaks = c(27, 57, by = 5))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green") +
scale_x_continuous(breaks = c(seq(27, 57), by = 5))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green") +
scale_x_continuous(breaks = seq(27, 57, by = 4))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green") +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?")
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green") +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5))
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula 'y ~ x') +
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5))
?geom_vline
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red")
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red", linetype = "dotted", size = 1)
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red", linetype = "dotted", size = 0.6)
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red", linetype = "dotted", size = 0.6)
ggsave(age_workload.pdf)
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red", linetype = "dotted", size = 0.6)
ggsave("age_workload.pdf")
absent <- read.csv(file = "/Users/yongyetan/Desktop/Area51/AbsenteeismAtWork/Absenteeism_at_work.csv", sep = ";")
absent %>%
group_by(Age) %>%
summarise(average = mean(Work.load.Average.day)) %>%
ggplot(aes(x = Age, y =  average)) +
geom_point(aes(color = Age)) +
geom_smooth(se = FALSE, color = "green", method = 'loess', formula = 'y ~ x') +
scale_x_continuous(breaks = seq(27, 57, by = 5)) +
labs(x = "age of worker",
y = "average amount of workload in a day",
title = "How much workload a worker receives as he/she ages",
subtitle = "the older, the fewer work?") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.subtitle = element_text(hjust = 0.5)) +
geom_vline(xintercept = 42, color = "red", linetype = "dotted", size = 0.6)
